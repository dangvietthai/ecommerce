(()=>{var e={};e.id=6992,e.ids=[6992],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},2361:e=>{"use strict";e.exports=require("events")},3685:e=>{"use strict";e.exports=require("http")},5687:e=>{"use strict";e.exports=require("https")},1808:e=>{"use strict";e.exports=require("net")},5477:e=>{"use strict";e.exports=require("punycode")},2781:e=>{"use strict";e.exports=require("stream")},4404:e=>{"use strict";e.exports=require("tls")},7310:e=>{"use strict";e.exports=require("url")},9796:e=>{"use strict";e.exports=require("zlib")},7443:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>l});var r=s(482),a=s(9108),n=s(2563),i=s.n(n),o=s(8300),c={};for(let e in o)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>o[e]);s.d(t,c);let l=["",{children:["coupons",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1621)),"C:\\Users\\dngvieth_23\\OneDrive\\Desktop\\local-shop\\src\\app\\coupons\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,4563)),"C:\\Users\\dngvieth_23\\OneDrive\\Desktop\\local-shop\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,9361,23)),"next/dist/client/components/not-found-error"]}],d=["C:\\Users\\dngvieth_23\\OneDrive\\Desktop\\local-shop\\src\\app\\coupons\\page.tsx"],u="/coupons/page",x={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/coupons/page",pathname:"/coupons",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},2594:(e,t,s)=>{Promise.resolve().then(s.bind(s,6311))},6311:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var r=s(5344),a=s(3729),n=s(8704),i=s(59);function o(){let[e,t]=(0,a.useState)([]),[s,o]=(0,a.useState)([]),[c,l]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async function(){try{let{data:{user:e},error:s}=await n.O.auth.getUser();if(s)throw s;let{data:r,error:a}=await n.O.from("coupons").select("*").eq("is_active",!0).gte("end_date",new Date().toISOString()).lte("start_date",new Date().toISOString()).order("created_at",{ascending:!1});if(a)throw a;if(t(r||[]),e){let{data:t,error:s}=await n.O.from("user_coupons").select(`
              *,
              coupons (*)
            `).eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;o(t||[])}}catch(e){console.error("Error fetching coupons:",e)}finally{l(!1)}})()},[]);let d=e=>{let t=new Date,s=new Date(e.start_date),r=new Date(e.end_date);return t<s?{status:"upcoming",text:"Sắp diễn ra",color:"text-blue-600 bg-blue-50"}:t>r?{status:"expired",text:"Đ\xe3 hết hạn",color:"text-red-600 bg-red-50"}:e.usage_limit&&e.used_count>=e.usage_limit?{status:"limit_reached",text:"Đ\xe3 hết lượt sử dụng",color:"text-red-600 bg-red-50"}:{status:"active",text:"Đang hoạt động",color:"text-green-600 bg-green-50"}};return c?(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.default,{}),r.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:r.jsx("div",{className:"container mx-auto px-4",children:(0,r.jsxs)("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),r.jsx("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[r.jsx("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-2"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},e))})]})})})]}):(0,r.jsxs)(r.Fragment,{children:[r.jsx(i.default,{}),r.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,r.jsxs)("div",{className:"container mx-auto px-4",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"M\xe3 giảm gi\xe1"}),(0,r.jsxs)("div",{className:"mb-12",children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"M\xe3 giảm gi\xe1 đang hoạt động"}),0===e.length?r.jsx("p",{className:"text-gray-500",children:"Hiện kh\xf4ng c\xf3 m\xe3 giảm gi\xe1 n\xe0o đang hoạt động."}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>{let t=d(e);return r.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${t.color}`,children:t.text})]}),r.jsx("div",{className:"mb-4",children:r.jsx("p",{className:"text-gray-600",children:e.description})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"percentage"===e.discount_type?`${e.discount_value}%`:`${e.discount_value.toLocaleString("vi-VN")}đ`}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.usage_limit&&(0,r.jsxs)("p",{children:["Đ\xe3 d\xf9ng: ",e.used_count,"/",e.usage_limit]}),(0,r.jsxs)("p",{children:["HSD: ",new Date(e.end_date).toLocaleDateString("vi-VN")]})]})]}),e.min_purchase_amount&&(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["\xc1p dụng cho đơn h\xe0ng từ ",e.min_purchase_amount.toLocaleString("vi-VN"),"đ"]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("code",{className:"text-lg font-mono bg-gray-100 px-3 py-1 rounded",children:e.code}),r.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Sao ch\xe9p"})]})]})},e.id)})})]}),(0,r.jsxs)("div",{children:[r.jsx("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"M\xe3 giảm gi\xe1 của t\xf4i"}),0===s.length?r.jsx("p",{className:"text-gray-500",children:"Bạn chưa c\xf3 m\xe3 giảm gi\xe1 n\xe0o."}):r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{let t=e.coupons,s=d(t);return r.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,r.jsxs)("div",{className:"p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),r.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${s.color}`,children:e.is_used?"Đ\xe3 sử dụng":s.text})]}),r.jsx("div",{className:"mb-4",children:r.jsx("p",{className:"text-gray-600",children:t.description})}),(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[r.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"percentage"===t.discount_type?`${t.discount_value}%`:`${t.discount_value.toLocaleString("vi-VN")}đ`}),(0,r.jsxs)("div",{className:"text-sm text-gray-500",children:[e.used_at&&(0,r.jsxs)("p",{children:["Đ\xe3 d\xf9ng: ",new Date(e.used_at).toLocaleString("vi-VN")]}),(0,r.jsxs)("p",{children:["HSD: ",new Date(t.end_date).toLocaleDateString("vi-VN")]})]})]}),t.min_purchase_amount&&(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["\xc1p dụng cho đơn h\xe0ng từ ",t.min_purchase_amount.toLocaleString("vi-VN"),"đ"]}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[r.jsx("code",{className:"text-lg font-mono bg-gray-100 px-3 py-1 rounded",children:t.code}),!e.is_used&&r.jsx("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Sao ch\xe9p"})]})]})},e.id)})})]})]})})]})}},1621:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>a,default:()=>i});let r=(0,s(6843).createProxy)(String.raw`C:\Users\dngvieth_23\OneDrive\Desktop\local-shop\src\app\coupons\page.tsx`),{__esModule:a,$$typeof:n}=r,i=r.default}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[1638,9572,5321],()=>s(7443));module.exports=r})();