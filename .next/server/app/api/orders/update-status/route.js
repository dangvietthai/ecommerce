"use strict";(()=>{var e={};e.id=2830,e.ids=[2830],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},1808:e=>{e.exports=require("net")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},4404:e=>{e.exports=require("tls")},7310:e=>{e.exports=require("url")},9796:e=>{e.exports=require("zlib")},4778:(e,r,t)=>{t.r(r),t.d(r,{headerHooks:()=>h,originalPathname:()=>g,patchFetch:()=>q,requestAsyncStorage:()=>l,routeModule:()=>p,serverHooks:()=>m,staticGenerationAsyncStorage:()=>c,staticGenerationBailout:()=>f});var s={};t.r(s),t.d(s,{POST:()=>d});var o=t(5419),a=t(9108),u=t(9678),n=t(8070),i=t(6517);async function d(e){try{let{orderId:r,status:t,payment_status:s}=await e.json();if(!r||!t)return n.Z.json({error:"Missing required fields"},{status:400});let{data:o,error:a}=await i.O.from("orders").select("payment_method").eq("id",r).single();if(a)return console.error("Error fetching order:",a),n.Z.json({error:"Failed to fetch order"},{status:500});let u={status:t,updated_at:new Date().toISOString()};"cod"===o.payment_method?"completed"===t?u.payment_status="paid":"cancelled"===t?u.payment_status="failed":u.payment_status="pending":u.payment_status=s||"pending";let{data:d,error:p}=await i.O.from("orders").update(u).eq("id",r).select().single();if(p)return console.error("Error updating order:",p),n.Z.json({error:"Failed to update order"},{status:500});return n.Z.json({success:!0,order:d,message:"Order updated successfully"})}catch(e){return console.error("Error updating order:",e),n.Z.json({error:"Internal server error"},{status:500})}}let p=new o.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/orders/update-status/route",pathname:"/api/orders/update-status",filename:"route",bundlePath:"app/api/orders/update-status/route"},resolvedPagePath:"C:\\Users\\dngvieth_23\\OneDrive\\Desktop\\local-shop\\src\\app\\api\\orders\\update-status\\route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:l,staticGenerationAsyncStorage:c,serverHooks:m,headerHooks:h,staticGenerationBailout:f}=p,g="/api/orders/update-status/route";function q(){return(0,u.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:c})}},6517:(e,r,t)=>{t.d(r,{O:()=>s});let s=(0,t(7699).createClientComponentClient)()}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[1638,6206,7699],()=>t(4778));module.exports=s})();