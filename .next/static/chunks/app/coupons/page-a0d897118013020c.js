(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6992],{5299:function(e,t,s){Promise.resolve().then(s.bind(s,6297))},6297:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return d}});var a=s(3827),n=s(4090),i=s(4958),c=s(8141);function d(){let[e,t]=(0,n.useState)([]),[s,d]=(0,n.useState)([]),[l,r]=(0,n.useState)(!0);(0,n.useEffect)(()=>{!async function(){try{let{data:{user:e},error:s}=await i.O.auth.getUser();if(s)throw s;let{data:a,error:n}=await i.O.from("coupons").select("*").eq("is_active",!0).gte("end_date",new Date().toISOString()).lte("start_date",new Date().toISOString()).order("created_at",{ascending:!1});if(n)throw n;if(t(a||[]),e){let{data:t,error:s}=await i.O.from("user_coupons").select("\n              *,\n              coupons (*)\n            ").eq("user_id",e.id).order("created_at",{ascending:!1});if(s)throw s;d(t||[])}}catch(e){console.error("Error fetching coupons:",e)}finally{r(!1)}}()},[]);let o=e=>{let t=new Date,s=new Date(e.start_date),a=new Date(e.end_date);return t<s?{status:"upcoming",text:"Sắp diễn ra",color:"text-blue-600 bg-blue-50"}:t>a?{status:"expired",text:"Đ\xe3 hết hạn",color:"text-red-600 bg-red-50"}:e.usage_limit&&e.used_count>=e.usage_limit?{status:"limit_reached",text:"Đ\xe3 hết lượt sử dụng",color:"text-red-600 bg-red-50"}:{status:"active",text:"Đang hoạt động",color:"text-green-600 bg-green-50"}};return l?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.default,{}),(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,a.jsx)("div",{className:"container mx-auto px-4",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4 mb-8"}),(0,a.jsx)("div",{className:"space-y-4",children:[1,2,3].map(e=>(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("div",{className:"h-6 bg-gray-200 rounded w-3/4 mb-2"}),(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2"})]},e))})]})})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.default,{}),(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,a.jsxs)("div",{className:"container mx-auto px-4",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"M\xe3 giảm gi\xe1"}),(0,a.jsxs)("div",{className:"mb-12",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"M\xe3 giảm gi\xe1 đang hoạt động"}),0===e.length?(0,a.jsx)("p",{className:"text-gray-500",children:"Hiện kh\xf4ng c\xf3 m\xe3 giảm gi\xe1 n\xe0o đang hoạt động."}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>{let t=o(e);return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:e.name}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(t.color),children:t.text})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("p",{className:"text-gray-600",children:e.description})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:"percentage"===e.discount_type?"".concat(e.discount_value,"%"):"".concat(e.discount_value.toLocaleString("vi-VN"),"đ")}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.usage_limit&&(0,a.jsxs)("p",{children:["Đ\xe3 d\xf9ng: ",e.used_count,"/",e.usage_limit]}),(0,a.jsxs)("p",{children:["HSD: ",new Date(e.end_date).toLocaleDateString("vi-VN")]})]})]}),e.min_purchase_amount&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["\xc1p dụng cho đơn h\xe0ng từ ",e.min_purchase_amount.toLocaleString("vi-VN"),"đ"]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("code",{className:"text-lg font-mono bg-gray-100 px-3 py-1 rounded",children:e.code}),(0,a.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Sao ch\xe9p"})]})]})},e.id)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 mb-6",children:"M\xe3 giảm gi\xe1 của t\xf4i"}),0===s.length?(0,a.jsx)("p",{className:"text-gray-500",children:"Bạn chưa c\xf3 m\xe3 giảm gi\xe1 n\xe0o."}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(e=>{let t=e.coupons,s=o(t);return(0,a.jsx)("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900",children:t.name}),(0,a.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium ".concat(s.color),children:e.is_used?"Đ\xe3 sử dụng":s.text})]}),(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsx)("p",{className:"text-gray-600",children:t.description})}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:"percentage"===t.discount_type?"".concat(t.discount_value,"%"):"".concat(t.discount_value.toLocaleString("vi-VN"),"đ")}),(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:[e.used_at&&(0,a.jsxs)("p",{children:["Đ\xe3 d\xf9ng: ",new Date(e.used_at).toLocaleString("vi-VN")]}),(0,a.jsxs)("p",{children:["HSD: ",new Date(t.end_date).toLocaleDateString("vi-VN")]})]})]}),t.min_purchase_amount&&(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["\xc1p dụng cho đơn h\xe0ng từ ",t.min_purchase_amount.toLocaleString("vi-VN"),"đ"]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("code",{className:"text-lg font-mono bg-gray-100 px-3 py-1 rounded",children:t.code}),!e.is_used&&(0,a.jsx)("button",{className:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700",children:"Sao ch\xe9p"})]})]})},e.id)})})]})]})})]})}}},function(e){e.O(0,[8714,8792,703,5558,8371,3649,8141,2971,8069,1744],function(){return e(e.s=5299)}),_N_E=e.O()}]);