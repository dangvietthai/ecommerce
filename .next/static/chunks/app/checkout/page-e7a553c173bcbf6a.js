(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[285],{9622:function(e,t,s){Promise.resolve().then(s.bind(s,645))},527:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(7977).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},7326:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(7977).Z)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},7664:function(e,t,s){"use strict";s.d(t,{Z:function(){return r}});let r=(0,s(7977).Z)("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},7907:function(e,t,s){"use strict";var r=s(5313);s.o(r,"useParams")&&s.d(t,{useParams:function(){return r.useParams}}),s.o(r,"usePathname")&&s.d(t,{usePathname:function(){return r.usePathname}}),s.o(r,"useRouter")&&s.d(t,{useRouter:function(){return r.useRouter}}),s.o(r,"useSearchParams")&&s.d(t,{useSearchParams:function(){return r.useSearchParams}})},645:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return h}});var r=s(3827),a=s(4090),n=s(6331),i=s(7907),l=s(527),c=s(7664),d=s(7326),o=s(8792),u=s(703),m=s(6288);function h(){let e=(0,i.useRouter)(),t=(0,n.j)(),[s,h]=(0,a.useState)({fullName:"",email:"",phone:"",address:"",note:""}),[x,g]=(0,a.useState)("vnpay"),[y,f]=(0,a.useState)(!1);if(0===t.items.length)return(0,r.jsxs)("div",{className:"min-h-[400px] flex flex-col items-center justify-center",children:[(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:"Giỏ h\xe0ng trống"}),(0,r.jsx)(o.default,{href:"/products",className:"text-red-600 hover:text-red-700",children:"Tiếp tục mua sắm"})]});let p=async r=>{r.preventDefault(),f(!0);try{if("vnpay"===x){let e=await fetch("/api/create-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({amount:t.getTotalPrice(),orderInfo:"Thanh toan don hang ".concat(s.fullName)})}),r=await e.json();if(!e.ok)throw Error(r.error||"Failed to create payment");m.toast.info("Đang chuyển đến trang thanh to\xe1n VNPay...",{duration:2e3}),setTimeout(()=>{try{window.location.href=r.paymentUrl}catch(e){console.error("Error redirecting to VNPay:",e),m.toast.error("Kh\xf4ng thể chuyển đến trang thanh to\xe1n. Vui l\xf2ng thử lại.")}},2e3);return}t.clearCart(),e.push("/order-success")}catch(e){console.error("Error:",e),m.toast.error("C\xf3 lỗi xảy ra. Vui l\xf2ng thử lại.")}finally{f(!1)}};return(0,r.jsx)("section",{className:"py-8",children:(0,r.jsxs)("div",{className:"container mx-auto px-4",children:[(0,r.jsxs)("div",{className:"text-sm text-gray-600 mb-6",children:[(0,r.jsx)(o.default,{href:"/",className:"hover:text-red-600",children:"Trang chủ"}),(0,r.jsx)("span",{className:"mx-2",children:"/"}),(0,r.jsx)(o.default,{href:"/cart",className:"hover:text-red-600",children:"Giỏ h\xe0ng"}),(0,r.jsx)("span",{className:"mx-2",children:"/"}),(0,r.jsx)("span",{className:"text-gray-900",children:"Thanh to\xe1n"})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,r.jsxs)("div",{className:"lg:col-span-2",children:[(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Th\xf4ng tin giao h\xe0ng"}),(0,r.jsxs)("form",{onSubmit:p,className:"space-y-4",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Họ v\xe0 t\xean"}),(0,r.jsx)("input",{type:"text",required:!0,value:s.fullName,onChange:e=>h({...s,fullName:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Số điện thoại"}),(0,r.jsx)("input",{type:"tel",required:!0,value:s.phone,onChange:e=>h({...s,phone:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,r.jsx)("input",{type:"email",required:!0,value:s.email,onChange:e=>h({...s,email:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Địa chỉ"}),(0,r.jsx)("input",{type:"text",required:!0,value:s.address,onChange:e=>h({...s,address:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ghi ch\xfa"}),(0,r.jsx)("textarea",{rows:3,value:s.note,onChange:e=>h({...s,note:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-600"})]})]})]}),(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Phương thức thanh to\xe1n"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex items-center p-4 border rounded-lg cursor-pointer transition-colors ".concat("vnpay"===x?"border-red-600 bg-red-50":"hover:border-red-600"),onClick:()=>g("vnpay"),children:[(0,r.jsx)(l.Z,{className:"w-6 h-6 text-gray-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium",children:"Thanh to\xe1n qua VNPay"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Thanh to\xe1n trực tuyến qua cổng thanh to\xe1n VNPay"})]})]}),(0,r.jsxs)("div",{className:"flex items-center p-4 border rounded-lg cursor-pointer transition-colors ".concat("cod"===x?"border-red-600 bg-red-50":"hover:border-red-600"),onClick:()=>g("cod"),children:[(0,r.jsx)(c.Z,{className:"w-6 h-6 text-gray-600 mr-3"}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium",children:"Thanh to\xe1n khi nhận h\xe0ng"}),(0,r.jsx)("p",{className:"text-sm text-gray-500",children:"Thanh to\xe1n bằng tiền mặt khi nhận h\xe0ng"})]})]})]})]})]}),(0,r.jsx)("div",{className:"lg:col-span-1",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Tổng đơn h\xe0ng"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"space-y-2",children:t.items.map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-lg",children:(0,r.jsx)(u.default,{src:e.image_url,alt:e.name,width:64,height:64,className:"w-full h-full object-cover rounded-lg"})}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium",children:e.name}),(0,r.jsxs)("p",{className:"text-sm text-gray-500",children:["Số lượng: ",e.quantity]})]})]}),(0,r.jsx)("span",{className:"font-medium",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e.price*e.quantity)})]},e.id))}),(0,r.jsxs)("div",{className:"border-t pt-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,r.jsx)("span",{children:"Tạm t\xednh"}),(0,r.jsx)("span",{children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t.getTotalPrice())})]}),(0,r.jsxs)("div",{className:"flex justify-between text-gray-600",children:[(0,r.jsx)("span",{children:"Ph\xed vận chuyển"}),(0,r.jsx)("span",{children:"Miễn ph\xed"})]}),(0,r.jsx)("div",{className:"border-t pt-2",children:(0,r.jsxs)("div",{className:"flex justify-between font-bold text-lg",children:[(0,r.jsx)("span",{children:"Tổng cộng"}),(0,r.jsx)("span",{className:"text-red-600",children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t.getTotalPrice())})]})})]}),(0,r.jsxs)("div",{className:"flex items-center justify-center text-sm text-gray-500 mt-4",children:[(0,r.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),(0,r.jsx)("span",{children:"Thanh to\xe1n an to\xe0n"})]}),(0,r.jsx)("button",{onClick:p,disabled:y,className:"w-full bg-red-600 text-white py-3 rounded-lg hover:bg-red-700 transition-colors mt-4 ".concat(y?"opacity-50 cursor-not-allowed":""),children:y?"Đang xử l\xfd...":"Đặt h\xe0ng"})]})]})})]})]})})}},6331:function(e,t,s){"use strict";s.d(t,{j:function(){return n}});var r=s(2020),a=s(5249);let n=(0,r.Ue)()((0,a.tJ)((e,t)=>({items:[],addToCart:t=>{e(e=>e.items.find(e=>e.id===t.id)?{items:e.items.map(e=>e.id===t.id?{...e,quantity:e.quantity+t.quantity}:e)}:{items:[...e.items,t]})},removeFromCart:t=>{e(e=>({items:e.items.filter(e=>e.id!==t)}))},updateQuantity:(t,s)=>{e(e=>({items:e.items.map(e=>e.id===t?{...e,quantity:s}:e)}))},clearCart:()=>{e({items:[]})},getTotalItems:()=>t().items.reduce((e,t)=>e+t.quantity,0),getTotalPrice:()=>t().items.reduce((e,t)=>e+t.price*t.quantity,0)}),{name:"cart-storage",storage:(0,a.FL)(()=>localStorage)}))}},function(e){e.O(0,[8792,703,5558,6288,2971,8069,1744],function(){return e(e.s=9622)}),_N_E=e.O()}]);